/**
 * Theme: theme-Serenity
 * Author: Serenity
 * Build: 2026-02-21 13:40:33
 * Fingerprint: a60e55b473a87906
 * Copyright © 2026 Serenity. All rights reserved.
 * Unauthorized copying or distribution is prohibited.
 */
document.addEventListener('DOMContentLoaded',function(){const alertElement=document.querySelector('.alert');if(alertElement){const message=alertElement.textContent.trim();const isError=alertElement.classList.contains('alert-error');const isSuccess=alertElement.classList.contains('alert-success');showToast(message,isError?'error':(isSuccess?'success':'info'));alertElement.remove();}setTimeout(function(){const loginForm=document.querySelector('#login-form')||document.querySelector('form[action*="login"]');if(loginForm){loginForm.addEventListener('submit',function(){const submitBtn=loginForm.querySelector('button[type="submit"]');if(submitBtn){submitBtn.disabled=true;submitBtn.textContent='登录中...';}});}const forgotPasswordLink=document.querySelector('.form-item-extra-link')||document.querySelector('a[href*="password-reset"]')||document.querySelector('a[href*="forgot"]');if(forgotPasswordLink){forgotPasswordLink.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();togglePasswordResetForm();});}},100);});function togglePasswordResetForm(){const formWrapper=document.querySelector('.halo-form-wrapper');const loginForm=document.querySelector('#login-form')||document.querySelector('.halo-form');if(!loginForm)return;if(formWrapper&&formWrapper.classList.contains('reset-mode')){showLoginForm();}else{showResetForm();}}function showResetForm(){const formWrapper=document.querySelector('.halo-form-wrapper');const loginForm=document.querySelector('#login-form')||document.querySelector('.halo-form');if(formWrapper){formWrapper.classList.add('reset-mode');}loginForm.style.display='none';const csrfToken=document.querySelector('input[name="_csrf"]');const csrfTokenValue=csrfToken?csrfToken.value:'';const resetFormHTML=`<form class="halo-form" id="reset-form" action="/password-reset/email" method="post"><input type="hidden" name="_csrf" value="${csrfTokenValue}" /><div class="form-item"><label for="reset-email">邮箱地址</label><div class="form-input"><input type="email" id="reset-email" name="email" required autocomplete="email" autofocus /></div></div><div class="form-item"><button type="submit">发送重置链接</button></div><div class="form-item" style="margin-top:16px;text-align:center;"><a href="#" class="form-item-extra-link" onclick="showLoginForm();return false;">返回登录</a></div></form>`;loginForm.insertAdjacentHTML('afterend',resetFormHTML);}function showLoginForm(){const formWrapper=document.querySelector('.halo-form-wrapper');const loginForm=document.querySelector('#login-form')||document.querySelector('.halo-form');const resetForm=document.querySelector('#reset-form');if(formWrapper){formWrapper.classList.remove('reset-mode');}if(loginForm){loginForm.style.display='block';}if(resetForm){resetForm.remove();}}